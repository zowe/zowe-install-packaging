################################################################################
# This program and the accompanying materials are made available under the terms of the
# Eclipse Public License v2.0 which accompanies this distribution, and is available at
# https://www.eclipse.org/legal/epl-v20.html
#
# SPDX-License-Identifier: EPL-2.0
#
# Copyright Contributors to the Zowe Project.
################################################################################

zowe:
  runtimeDirectory: /global/zowe/runtime
  # where extensions are installed
  # extensionDirectory: /global/zowe/extensions
  jobPrefix: ZWE
  identifier: "1"
  externalDomains:
    # this should be the domain name of you Dynamic VIP Address (DVIPA)
    - dvipa.my-company.com
  
  # you can define any extra environment variables here
  environments:
    # this is optional and be kept for backward compatible purpose
    # all certificate configuration are defined in this file
    KEYSTORE_DIRECTORY: /global/zowe/keystore
    ZOWE_ZLUX_SSH_PORT: "22"
    ZOWE_ZLUX_TELNET_PORT: "23"
    ZOWE_ZLUX_SECURITY_TYPE: ""
    EXTERNAL_ROOT_CA: ""
    SSO_FALLBACK_TO_NATIVE_AUTH: "true"

  # enable debug mode for zowe launch scripts
  # launchScript:
  #   logLevel: debug

  # this should be the port you defined on DVIPA for gateway external port
  externalPort: "7554"

  # default certificate for gateway external connector
  # this is required.
  externalCertificate:
    keystore:
      alias: localhost
      password: password
      file: /global/zowe/keystore/localhost/localhost.keystore.p12
      type: PKCS12
    trustStore:
      file: /global/zowe/keystore/localhost/localhost.truststore.p12
      certificateAuthorities: ""
    pem:
      key: /global/zowe/keystore/localhost/localhost.keystore.key
      certificate: /global/zowe/keystore/localhost/localhost.keystore.cer-ebcdic
      certificateAuthority: /global/zowe/keystore/local_ca/localca.cer-ebcdic
  # default certificate for all components, also gateway internal connector
  # this is optional. If this section is missing, all components will fall back to "zowe.externalCertificate".
  internalCertificate:
    keystore:
      alias: localhost
      password: password
      file: /global/zowe/keystore/localhost/localhost.keystore.p12
      type: PKCS12
    trustStore:
      file: /global/zowe/keystore/localhost/localhost.truststore.p12
      certificateAuthorities: ""
    pem:
      key: /global/zowe/keystore/localhost/localhost.keystore.key
      certificate: /global/zowe/keystore/localhost/localhost.keystore.cer-ebcdic
      certificateAuthority: /global/zowe/keystore/local_ca/localca.cer-ebcdic
  sso:
    token:
      name: ""
      label: ""

# customize java
java:
  home: /usr/lpp/java/J8.0_64
# customize node.js
node:
  home: /global/nodejs/v14/node-v14.15.1-os390-s390x
# define z/OSMF
zOSMF:
  host: dvipa.my-company.com
  port: "443"
  applId: IZUDFLT

# this section defines default configurations of components
# by default, like defined here, all components are "enabled".
components:
  gateway:
    enabled: true
    port: "7554"
    apiml:
      service:
        allowEncodedSlashes: true
        corsEnabled: false
        preferIpAddress: false
      gateway:
        timeoutMillis: "600000"
      security:
        x509:
          enabled: false
          externalMapperUrl: https://dvipa.my-company.com:7554/zss/api/v1/certificate/x509/map
        zosmf:
          applid: IZUDFLT
        auth:
          provider: zosmf
        authorization:
          endpoint:
            url: https://dvipa.my-company.com:7554/zss/api/v1/saf-auth
        ssl:
          verifySslCertificatesOfServices: false
          nonStrictVerifySslCertificatesOfServices: true
    debug: false
    server:
      maxConnectionsPerRoute: "100"
      maxTotalConnections: "1000"
    # gateway supports internal connector, and we can use the dedicate certificate generated by zowe-setup-certificates.sh
    # the missing definitions will be picked from "zowe.internalCertificate"
    internalCertificate:
      keystore:
        alias: gateway
      pem:
        key: /global/zowe/keystore/localhost/localhost.keystore.gateway.key
        certificate: /global/zowe/keystore/localhost/localhost.keystore.gateway.cer-ebcdic
  discovery:
    enabled: true
    port: "7553"
    apiml:
      service:
        preferIpAddress: false
      security:
        ssl:
          verifySslCertificatesOfServices: false
          nonStrictVerifySslCertificatesOfServices: true
    debug: false
    alternativeStaticApiDefinitionsDirectories: ""
  api-catalog:
    enabled: true
    port: "7552"
    environment:
      preferIpAddress: false
    debug: false
  caching-service:
    enabled: true
    environment:
      preferIpAddress: false
    port: "7555"
    storage:
      size: "10000"
      evictionStrategy: reject
      mode: VSAM
      vsam:
        # your VSAM data set created by ZWECSVSM job
        name: ""
    apiml:
      security:
        ssl:
          verifySslCertificatesOfServices: false
          nonStrictVerifySslCertificatesOfServices: true
  app-server:
    enabled: true
    port: "8544"
    # we can customize app-server certificate
    # the missing definitions will be picked from "zowe.internalCertificate"
    certificate:
      keystore:
        alias: app-server
      pem:
        key: /global/zowe/keystore/localhost/localhost.keystore.app-server.key
        certificate: /global/zowe/keystore/localhost/localhost.keystore.app-server.cer-ebcdic
  zss:
    enabled: true
    port: "8542"
    crossMemoryServerName: ZWESIS_STD
    tls: true
    # we can customize zss certificate
    # the missing definitions will be picked from "zowe.internalCertificate"
    certificate:
      keystore:
        alias: zss
      pem:
        key: /global/zowe/keystore/localhost/localhost.keystore.zss.key
        certificate: /global/zowe/keystore/localhost/localhost.keystore.zss.cer-ebcdic
  jobs-api:
    enabled: true
    port: "8545"
  files-api:
    enabled: true
    port: "8547"
  explorer-jes:
    enabled: true
    port: "8546"
    frameAncestors: dvipa.my-company.com:*
  explorer-mvs:
    enabled: true
    port: "8548"
    frameAncestors: dvipa.my-company.com:*
  explorer-uss:
    enabled: true
    port: "8550"
    frameAncestors: dvipa.my-company.com:*
  # for extensions, you can add your definition like this
  # my-extension:
  #   enabled: true

# we can customize configurations for each HA instance
haInstances:
  # HA instance ID
  lpar1:
    # hostname where this instance will be started
    hostname: lpar1.my-company.com
    ip: 10.0.0.10
    # for this HA instance, we didn't customize "components", so it will use default value.
  
  # HA instance ID, we will start 2 instances on LPAR2
  # Please note, we can only start one gateway in same LPAR
  lpar2a:
    # hostname where this instance will be started
    hostname: lpar2.my-company.com
    ip: 10.0.0.11

    # these configurations will overwrite highest level "components" definitions
    components:
      discovery:
        # use customized port on this instance
        port: "17553"
      api-catalog:
        port: "17552"
      app-server:
        # no app-server in this instance
        enabled: false
      zss:
        # no app-server in this instance
        enabled: false
      jobs-api:
        port: "18545"
      files-api:
        port: "18547"
      explorer-jes:
        port: "18546"
      explorer-mvs:
        port: "18548"
      explorer-uss:
        port: "18550"
      caching-service:
        port: "17555"
  lpar2b:
    hostname: lpar2.my-company.com
    ip: 10.0.0.11

    # these configurations will overwrite highest level "components" definitions
    components:
      gateway:
        enabled: false
      discovery:
        enabled: false
      api-catalog:
        enabled: false
      app-server:
        enabled: false
        port: "28544"
      zss:
        port: "28542"
      jobs-api:
        enabled: true
      files-api:
        enabled: false
      explorer-jes:
        enabled: false
      explorer-mvs:
        enabled: false
      explorer-uss:
        enabled: false
      caching-service:
        enabled: false
